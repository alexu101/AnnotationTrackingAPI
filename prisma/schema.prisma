generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id String @id @default(uuid())
  name String @unique
  email String @unique
  password String
  role Role @relation(fields: [roleId], references: [id])
  roleId String
  state String @default("active")
  norm Int
  level String
  projects Project[] @relation("UserProjects")
  workDays WorkDay[]
  tasks Task[]
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Project {
  id String @id @default(uuid())
  name String @unique
  description String
  priority String
  state String
  configurations Configuration[]
  tasks Task[]
  files File[]
  users User[] @relation("UserProjects")
  autoFileAssignation Boolean @default(false)
  multipleFileAssignation Boolean @default(false)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Task {
  id String @id @default(uuid())
  name String
  priority String
  state String
  progress Int @default(0)
  startDate DateTime
  endDate DateTime
  project Project @relation(fields: [projectId], references: [id])
  projectId String
  users User[]
  files File[]
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model File {
  id String @id @default(uuid())
  name String
  projects Project[]
  projectId String
  // fileInfos FileInfo[]
  tasks Task[]
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

// model FileInfos {
//   id String @id @default(uuid())
//   file File @relation(fields: [fileId], references: [id])
//   fileId String
//   complexity String
//   location String
//   state String
//   startDate DateTime
//   endDate DateTime
//   createdAt DateTime @default(now())
//   updatedAt DateTime @updatedAt
// }

model Configuration {
  id String @id @default(uuid())
  projects Project[]
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model WorkDay {
  id String @id @default(uuid())
  user User @relation(fields: [userId], references: [id])
  userId String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Role {
  id String @id @default(uuid())
  users User[]
  name String @unique
  permissions Permission[]
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Permission {
  id String @id @default(uuid())
  value String @unique
  roles Role[]
  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())
}